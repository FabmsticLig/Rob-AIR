#!/bin/bash


startme() {
  if [ ! -f $ROBAIR_HOME/catkin_ws/src/robairmain/launch/robair.launch ]; then
    cp $ROBAIR_HOME/configs/robair.launch $ROBAIR_HOME/catkin_ws/src/robairmain/launch/
  fi
  roslaunch robairmain robair.launch
}

stopme() {
  pkill -SIGINT -f roslaunch
}

restart() {
  pkill -9 -f "robairmain/proxy"
  stopme
  sleep 3
  startme
}


update() {
  stopme
  cd $ROBAIR_HOME
  git pull
  cd catkin_ws
  catkin_make
  cd ../arduino/robairarduino
  arduino --upload robairarduino.ino
  cd $ROBAIR_HOME
  echo "$(tput setaf 2)RobAIR a été mis à jour$(tput sgr0)"
}

case "$1" in
    start)   startme ;;
    stop)    stopme ;;
    restart) restart ;;
    update) update ;;
    *) echo "usage: $0 start|stop|restart|update" >&2
       exit 1
       ;;
esac
